!function(e){e.fn.googleDrivePicker=function(i){var o,c;function n(i){e(i).attr("data-picker-inited")||gapi.load("picker",(function(){e(i).attr("data-picker-inited",!0),i.disabled=!1,i.addEventListener("click",(function(){var i;c||(c=google.accounts.oauth2.initTokenClient({client_id:s.clientId,scope:s.scope,callback:""})),i=function(){var i=(new google.picker.DocsView).setIncludeFolders(!0),c=(new google.picker.DocsUploadView).setIncludeFolders(!0);s.mimeTypes&&(i.setMimeTypes(s.mimeTypes),c.setMimeTypes(s.mimeTypes)),(new google.picker.PickerBuilder).addView(i).addView(c).setOAuthToken(o).setDeveloperKey(s.developerKey).setCallback(t).build().setVisible(!0),setTimeout((function(){e(".picker-dialog").css("z-index",10002)}),20)},c.callback=async e=>{if(void 0!==e.error)throw e;o=e.access_token,i()},c.requestAccessToken({prompt:""})}))}))}function t(e){if(e[google.picker.Response.ACTION]==google.picker.Action.PICKED){var i=[];e[google.picker.Response.DOCUMENTS].forEach((function(e){i.push({name:e[google.picker.Document.NAME],link:e[google.picker.Document.URL],mime:e[google.picker.Document.MIME_TYPE]})})),"function"==typeof s.onPick?s.onPick(i):window[s.onPick](i)}}var s=e.extend({},e.fn.googleDrivePicker.defaults,i);return this.each((function(){s.clientId?(e(this).data("on-pick")&&(s.onPick=e(this).data("on-pick")),n(e(this)[0]),e(this).css("opacity",1)):e(this).css("opacity",0)}))}}(jQuery),$.fn.googleDrivePicker.defaults={scope:"https://www.googleapis.com/auth/drive",mimeTypes:null,developerKey:"",clientId:"",onPick:function(e){}};
